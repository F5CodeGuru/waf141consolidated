<!DOCTYPE html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Exercise 1.3: Proactive Bot Defense &#8212; GoodWAFSec Docs 1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Module 2: Transparent Security Policy" href="../../module2/module2.html" />
    <link rel="prev" title="Exercise 1.1: Policy Creation" href="../lab1/lab1.html" />
<!--
# Copyright 2017 F5 Networks
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
-->
<link href="https://cdn.f5.com/favicon.ico" rel="icon">
<script src="https://use.fontawesome.com/21fb8a09c3.js"></script>
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head><body>
  <div class="container-fluid">
  <div class="row corp-header">
    <div class="container corp-header">
      <div class="container corp-menu">
        <ul>
          <li><a href="https://f5.com" class="internalLink">F5.com</a></li>
          <li><a href="https://support.f5.com">Support</a></li>
          <li><a href="https://devcentral.f5.com">Community</a></li>
          <li><a href="https://github.com/F5Networks">GitHub</a></li>
          <li><a href="https://f5.com/about-us/careers">Careers</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="row pageHeader">
    <div class="container stat">
      <div class="col-xs-12 stat">
        <a class="internalLink" href="https://f5.com">
          <img class="logo" src="https://cdn.f5.com/websites/support/assets/images/logo.svg" width="50" height="44" alt="F5 Networks" title="F5 Networks" border="0">
        </a>
        <ul id="MainMenu" class="main-menu">
          <li>
            <a href="#">Products
              <span class="indicator"><span class="arrow-up"></span></span>
            </a>

            <div class="menu-panel soft-hide" id="ProductsSubmenu">
              <div class="container">
                <ul class="submenu col-sm-11">
                  <li class="third"><span class="a-mm-h">BIG-IP Controllers</span>
                    <ul>
                      <li><a href="/products/connectors/cf-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 BIG-IP Controller for Cloud Foundry</a></li>
                      <li><a href="/products/connectors/k8s-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 BIG-IP Controller for Kubernetes/OpenShift</a></li>
                      <li><a href="/products/connectors/marathon-bigip-ctlr/latest" data-link-type="Nav: Mega">F5 BIG-IP Controller for Marathon</a></li>
                    </ul>
                    <!-- unnecessary right now, we have them all listed>
                      <span class="seemore"><a data-link-type="Nav: Mega" href="/products/connectors">See all </a></span><-->
                    <span class="a-mm-h">Application Services Proxy</span>
                    <ul>
                      <li><a href="/products/asp/latest" data-link-type="Nav: Mega">F5 Application Services Proxy</a></li>
                      <li><a href="/products/connectors/f5-kube-proxy/latest" data-link-type="Nav: Mega">F5-kube-proxy</a></li>
                      <li><a href="/products/connectors/marathon-asp-ctlr/latest" data-link-type="Nav: Mega">F5 ASP Controller for Marathon</a></li>
                    </ul>
                    <!-- unnecessary>
                    <span class="seemore"><a href="/products/asp/latest">See all </a></span>
                    --->
                  </li>
                  <li class="divider"></li>
                  <li class="third"><span class="a-mm-h">OpenStack</span>
                    <ul>
                      <li><a href="/products/openstack/agent/latest" data-link-type="Nav: Mega">F5 Agent - OpenStack Neutron</a></li>
                      <li><a href="/products/openstack/lbaasv2-driver/latest" data-link-type="Nav: Mega">F5 Driver - OpenStack LBaaS</a></li>
                      <li><a href="/products/openstack/heat-plugins/latest" data-link-type="Nav: Mega">F5 Plugins - OpenStack Heat</a></li>
                     </ul>
                    <!--
                    <span class="seemore"><a href="/products/index.html">See all </a></span>
                    --->
                  </li>
                  <li class="divider"></li>
                  <li class="third"><span class="a-mm-h">Orchestration Templates</span>
                  <ul>
                    <li><a href="https://github.com/F5Networks/f5-aws-cloudformation" target="_blank">F5 Templates for AWS CloudFormation</a> </li>
                    <li><a href="https://github.com/F5Networks/f5-azure-arm-templates" target="_blank">F5 Templates for Azure ARM</a> </li>
                    <li><a href="https://github.com/F5Networks/f5-google-gdm-templates" target="_blank">F5 Templates for Google Cloud Deployment Manager</a> </li>
                    <li><a href="/products/templates/openstack-heat/latest" data-link-type="Nav: Mega">F5 Templates for OpenStack Heat</a></li>
                  </ul>
                    <!--
                    <span class="seemore"><a href="/products/index.html">See all </a></span>
                    --->
                </ul>
              </div>
            </div>
          </li>
          <li>
            <a href="#">Cloud & Container Integrations
              <span class="indicator"><span class="arrow-up"></span></span>
            </a>

            <div class="menu-panel soft-hide" id="ContainersSubmenu">
              <div class="container">
                <ul class="submenu col-sm-11">
                    <!--- HIDE, ALL ARE CURRENTLY DISPLAYED>
                    <span class="seemore"><a data-link-type="Nav: Mega" href="/containers/latest/">See all </a></span>
                    --->
                  <li class="third"><span class="a-mm-h">Clouds</span>
                    <ul>
                      <li><a href="/cloud/public/v1" data-link-type="Nav: Mega">AWS</a></li>
                      <li><a href="/cloud/public/v1" data-link-type="Nav: Mega">Azure</a></li>
                      <li><a href="/cloud/public/v1" data-link-type="Nav: Mega">Google Cloud</a></li>
                      <li><a href="/cloud/openstack/" data-link-type="Nav: Mega">OpenStack</a></li>
                    </ul>
                    <!-- unnecessary right now>
                    <span class="seemore"><a data-link-type="Nav: Mega" href="/cloud/">See all </a></span>
                    <-->
                  <li class="divider"></li>
                  <li class="third"><span class="a-mm-h">Containers</span>
                    <ul>
                      <li><a href="/containers/latest/cloudfoundry/" data-link-type="Nav: Mega">Cloud Foundry</a> </li>
                      <li><a href="/containers/latest/kubernetes/" data-link-type="Nav: Mega">Kubernetes</a></li>
                      <li><a href="/containers/latest/marathon/" data-link-type="Nav: Mega">Mesos Marathon</a></li>
                      <li><a href="/containers/latest/openshift/" data-link-type="Nav: Mega">OpenShift</a></li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </li>
          <li>
            <a href="#">Resources
              <span class="indicator"><span class="arrow-up"></span></span>
            </a>
            <div class="menu-panel soft-hide" id="UPCProgramSubmenu">
              <div class="container">
                <ul class="submenu col-sm-11">
                  <li class="third">
                    <span class="a-mm-h">Downloads</span>
                    <ul>
                      <li><a target="_blank" data-link-type="Nav: Mega" href="https://hub.docker.com/r/f5networks/" class="internalLink">Docker Hub</a></li>
                      <li><a target="_blank" data-link-type="Nav: Mega" href="https://store.docker.com/images/f5networks-asp" class="internalLink">Docker Store</a></li>
                    </ul>
                    <span class="a-mm-h">OpenSource</span>
                  <ul>
                    <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5Networks" class="internalLink">F5Networks on GitHub</a></li>
                    <li><a target="_blank" data-link-type="Nav: Mega" href="https://github.com/F5DevCentral" class="internalLink">F5DevCentral on GitHub</a></li>
                  </ul>
                    </li>
                  <li class="divider"></li>
                  <li class="third">
                  <span class="a-mm-h">Training & Labs</span>
                   <ul>
                  <li><p>Learn how to get the most out of the F5 platform</p></li>
                    <li><a href="/training/community">Community</a></li>
                  </ul>
                  </li>
                  <li class="divider"></li>
                  
                  <li class="third">
                    <a href="//university.f5.com" class="a-mm-h internalLink" target="_blank" data-link-type="Nav: Mega">F5 University</a>
                    <ul>
                      <li>
                        <p>Get up to speed with free self-paced courses</p>
                      </li>
                    </ul>
                    <a data-ng-href="https://devcentral.f5.com" class="a-mm-h internalLink" target="_blank" data-link-type="Nav: Mega" href="https://devcentral.f5.com">DevCentral</a>
                    <ul>
                      <li>
                        <p>Join the community of 250,000+ technical peers</p>
                      </li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div> <!-- /container-fluid -->

  <div class="container-fluid">
    <div class="row">
      <div class="col-sm-3 col-md-3 sidebartoc">
         <h4><a href="../../">GoodWAFSec Docs 1.0</a></h4>
  <p class="caption">
   <span class="caption-text">Current Page</span>
  </p>
  <ul>
<li><a class="reference internal" href="#">Exercise 1.3: Proactive Bot Defense</a><ul>
<li><a class="reference internal" href="#create-policy">Create Policy</a></li>
<li><a class="reference internal" href="#configure-policy">Configure Policy</a></li>
<li><a class="reference internal" href="#apply-proactive-bot-defense-policy">Apply Proactive Bot Defense Policy</a></li>
<li><a class="reference internal" href="#create-bot-defense-logging-profile">Create Bot Defense Logging Profile</a></li>
<li><a class="reference internal" href="#apply-bot-defense-logging-profile">Apply Bot Defense Logging Profile</a></li>
<li><a class="reference internal" href="#test-the-proactive-bot-defense-policy">Test the Proactive Bot Defense Policy</a></li>
<li><a class="reference internal" href="#validate-that-the-proactive-bot-defense-policy-is-working">Validate that the Proactive Bot Defense Policy is Working</a></li>
<li><a class="reference internal" href="#bot-signatures">BOT Signatures</a></li>
<li><a class="reference internal" href="#selectively-blocking-bot-categories">Selectively Blocking BOT Categories</a></li>
<li><a class="reference internal" href="#curl-from-different-geolocations">cURL from Different Geolocations</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../lab1/lab1.html"
                        title="previous chapter">Exercise 1.1: Policy Creation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../module2/module2.html"
                        title="next chapter">Module 2: Transparent Security Policy</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/module1/lab2/lab2.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <form class="search" action="../../search.html" method="get">
    <div>
      <input type="text" name="q" placeholder="Search" style="padding-left: 6px;"/>
      <!-- <input type="submit" value="Go" style="margin-top: 4px;"/> -->
      <button type="submit" class="btn btn-primary btn-xs">Go</button>
    </div>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        
      </div>
      <div class="col-md-offset-3 col-sm-offset-3 main">
        <h4>
          <a href="/">Cloud Docs Home</a> &gt; <a href="../../index.html">GoodWAFSec Docs</a>
          <span class="right"><a href="../../genindex.html">Index</a></span>
        </h4>
        
  <div class="section" id="exercise-1-3-proactive-bot-defense">
<h1>Exercise 1.3: Proactive Bot Defense<a class="headerlink" href="#exercise-1-3-proactive-bot-defense" title="Permalink to this headline">¶</a></h1>
<p>Objective</p>
<ul class="simple">
<li>Create a DoS profile</li>
<li>Enable proactive bot defense</li>
<li>Apply the policy to the appropriate virtual server</li>
<li>Validate that the policy is working as expected</li>
<li>Estimated time for completion: <strong>20</strong> <strong>minutes</strong></li>
</ul>
<div class="section" id="create-policy">
<h2>Create Policy<a class="headerlink" href="#create-policy" title="Permalink to this headline">¶</a></h2>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">To clearly demonstrate just the Bot Defense profile,
please <strong>disable the Application Security Policy and iRule from the prior lab</strong> from the
<code class="docutils literal notranslate"><span class="pre">webgoat.f5demo.com_https_vs</span></code> virtual server!</p>
</div>
<a class="reference internal image-reference" href="../../_images/image17.PNG"><img alt="../../_images/image17.PNG" src="../../_images/image17.PNG" style="width: 600px;" /></a>
<a class="reference internal image-reference" href="../../_images/image21.PNG"><img alt="../../_images/image21.PNG" src="../../_images/image21.PNG" style="width: 600px;" /></a>
<ol class="arabic">
<li><p class="first">Open the <strong>Terminal</strong> application.</p>
</li>
<li><p class="first">Run the following curl command to verify the site is loading without issue from this command line http utility. If the curl command is not successful (you are getting a “request rejected” error page), please let an instructor know.</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">https://webgoat.f5demo.com/WebGoat/login</span> <span class="pre">-k</span> <span class="pre">-v</span> <span class="pre">|</span> <span class="pre">more</span></code></p>
</li>
</ol>
<dl class="docutils">
<dt>Input</dt>
<dd><a class="first last reference internal image-reference" href="../../_images/image36.PNG"><img alt="../../_images/image36.PNG" src="../../_images/image36.PNG" style="width: 600px;" /></a>
</dd>
<dt>Output</dt>
<dd><a class="first last reference internal image-reference" href="../../_images/image30.PNG"><img alt="../../_images/image30.PNG" src="../../_images/image30.PNG" style="width: 600px;" /></a>
</dd>
</dl>
<ol class="arabic">
<li><p class="first">On the Main tab, click&nbsp;<strong>Security &gt; DoS Protection &gt; DoS Profiles</strong>.
The DoS Profiles screen opens.</p>
<a class="reference internal image-reference" href="../../_images/image1_3_2.PNG"><img alt="../../_images/image1_3_2.PNG" src="../../_images/image1_3_2.PNG" style="width: 600px;" /></a>
</li>
<li><p class="first">Click on the <strong>Create</strong> button.</p>
</li>
<li><p class="first">Name the policy <code class="docutils literal notranslate"><span class="pre">webgoat_DoS</span></code> and click <strong>Finished</strong> to
complete the creation of this DoS profile.</p>
<a class="reference internal image-reference" href="../../_images/image1_3_3.PNG"><img alt="../../_images/image1_3_3.PNG" src="../../_images/image1_3_3.PNG" style="width: 600px;" /></a>
</li>
</ol>
</div>
<div class="section" id="configure-policy">
<h2>Configure Policy<a class="headerlink" href="#configure-policy" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first"><strong>Click</strong> the newly created <code class="docutils literal notranslate"><span class="pre">webgoat_DoS</span></code> profile listed under the
<strong>Security &gt; Dos Protection &gt; DoS Profiles</strong> list.</p>
</li>
<li><p class="first">The profile’s properties menu will be displayed initially. <strong>Click</strong>
on the <strong>Application Security</strong> tab at the top of this menu to
begin configuring the policy.</p>
<a class="reference internal image-reference" href="../../_images/image1_3_4.PNG"><img alt="../../_images/image1_3_4.PNG" src="../../_images/image1_3_4.PNG" style="width: 600px;" /></a>
</li>
<li><p class="first">Under the <strong>Application Security</strong> tab &gt; General Settings
click the <strong>Edit</strong> link on the right-hand side of General Settings
box and then check the <code class="docutils literal notranslate"><span class="pre">Enabled</span></code> check box for <strong>Application
Security</strong> to enable the DoS profile and allow additional settings
to be configured.</p>
<a class="reference internal image-reference" href="../../_images/image1_3_5.PNG"><img alt="../../_images/image1_3_5.PNG" src="../../_images/image1_3_5.PNG" style="width: 600px;" /></a>
</li>
<li><p class="first">Select <strong>Proactive Bot Defense</strong> under the list of <strong>Application
Security</strong> options for this DoS profile.</p>
</li>
<li><p class="first">Click the <strong>Edit</strong> link on the right for the <strong>Application
Security &gt; Proactive Bot Defense</strong> menu and select <strong>Always</strong>
from the drop-down menu for <strong>Operation Mode</strong>.</p>
</li>
<li><p class="first">Set the Grace Period to 20 seconds. We will observe this in action shortly.</p>
<a class="reference internal image-reference" href="../../_images/image37.PNG"><img alt="../../_images/image37.PNG" src="../../_images/image37.PNG" style="width: 600px;" /></a>
</li>
<li><p class="first">Notice that for <strong>Block requests from suspicious browsers</strong> the
<strong>Block Suspicious Browsers</strong> setting is enabled by default.</p>
</li>
<li><p class="first">At this point, you may want to take a moment and explore the other defaults that were turned on such as TPS based detection and BOT Signatures. Please don’t modify the defaults.</p>
</li>
<li><p class="first">Click the <strong>Update</strong> button to complete the Proactive Bot
Defense <code class="docutils literal notranslate"><span class="pre">webgoat_DoS</span></code> profile.</p>
<a class="reference internal image-reference" href="../../_images/image1_3_7.PNG"><img alt="../../_images/image1_3_7.PNG" src="../../_images/image1_3_7.PNG" style="width: 600px;" /></a>
</li>
</ol>
</div>
<div class="section" id="apply-proactive-bot-defense-policy">
<h2>Apply Proactive Bot Defense Policy<a class="headerlink" href="#apply-proactive-bot-defense-policy" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Under&nbsp;<strong>Local Traffic&nbsp;&gt;&nbsp;Virtual Servers</strong>, click
on&nbsp;<code class="docutils literal notranslate"><span class="pre">webgoat.f5demo.com_https_vs</span></code>.</p>
</li>
<li><p class="first">Click on&nbsp;<strong>Policies</strong>&nbsp;under the&nbsp;<strong>Security</strong>&nbsp;tab at the top of
the&nbsp;<code class="docutils literal notranslate"><span class="pre">webgoat.f5demo.com_https_vs</span></code> details menu.</p>
</li>
<li><p class="first">In the&nbsp;<strong>DoS Protection Profile</strong> drop down menu,
select&nbsp;<code class="docutils literal notranslate"><span class="pre">Enabled...</span></code> and then select the <code class="docutils literal notranslate"><span class="pre">webgoat_DoS</span></code> for
the profile.</p>
</li>
<li><p class="first">Click on the&nbsp;<strong>Update</strong>&nbsp;button to apply the policy.</p>
<a class="reference internal image-reference" href="../../_images/image1_3_8.PNG"><img alt="../../_images/image1_3_8.PNG" src="../../_images/image1_3_8.PNG" style="width: 600px;" /></a>
</li>
</ol>
</div>
<div class="section" id="create-bot-defense-logging-profile">
<h2>Create Bot Defense Logging Profile<a class="headerlink" href="#create-bot-defense-logging-profile" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Open a new tab for the Configuration Utility and navigate to:
&nbsp;<strong>Security &gt; Event Logs &gt; Logging Profiles</strong>&nbsp;then <strong>click
the plus icon</strong>.</p>
</li>
<li><p class="first">Enter a Profile Name&nbsp;<code class="docutils literal notranslate"><span class="pre">bot-defense</span></code>, select the
checkbox for&nbsp;<code class="docutils literal notranslate"><span class="pre">Bot</span> <span class="pre">Defense</span></code>.</p>
</li>
<li><p class="first">Under the&nbsp;<strong>Bot Defense</strong> logging section, select the checkboxes
for the following: <code class="docutils literal notranslate"><span class="pre">Local</span> <span class="pre">Publisher</span></code>, <code class="docutils literal notranslate"><span class="pre">Log</span> <span class="pre">Illegal</span> <span class="pre">Requests</span></code>, <code class="docutils literal notranslate"><span class="pre">Log</span> <span class="pre">Bot</span> <span class="pre">Signature</span> <span class="pre">Matched</span> <span class="pre">Requests</span></code> and
<code class="docutils literal notranslate"><span class="pre">Log</span> <span class="pre">Challenged</span> <span class="pre">Requests</span></code>.</p>
</li>
<li><p class="first">Click&nbsp;<strong>Finished</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You could have also modified the existing <code class="docutils literal notranslate"><span class="pre">waf_allrequests</span></code>
logging profile and added BOT logging definitions.</p>
</div>
<a class="reference internal image-reference" href="../../_images/image33.PNG"><img alt="../../_images/image33.PNG" src="../../_images/image33.PNG" style="width: 600px;" /></a>
</li>
</ol>
</div>
<div class="section" id="apply-bot-defense-logging-profile">
<h2>Apply Bot Defense Logging Profile<a class="headerlink" href="#apply-bot-defense-logging-profile" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Under&nbsp;<strong>Local Traffic &gt; Virtual Servers</strong>, click
on&nbsp;<code class="docutils literal notranslate"><span class="pre">webgoat.f5demo.com_https_vs</span></code>.</p>
</li>
<li><p class="first">Click on&nbsp;<strong>Policies</strong>&nbsp;under the&nbsp;<strong>Security</strong>&nbsp;tab at the top</p>
</li>
<li><p class="first">Within the Available logging profiles menu,
select <code class="docutils literal notranslate"><span class="pre">bot-defense</span></code> and then click
the <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> arrows to move the logging policy to
the <code class="docutils literal notranslate"><span class="pre">Selected</span></code> profile.</p>
</li>
<li><p class="first">Click on the&nbsp;<strong>Update</strong>&nbsp;button to apply the policy.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can associate multiple logging profiles with a given
virtual server. F5 allows for an incredible amount of logging
flexibility. Most commonly you would have DoS, Bot Defense and ASM
Security Policy events logged to a centralized SIEM platform, but
there may be additional logging requirements such as a web team that
would be interested in Bot Defense logs solely, while the SIEM
continues to receive the union of DoS, Bot Defense and ASM Security
Policy events.</p>
</div>
<a class="reference internal image-reference" href="../../_images/image34.PNG"><img alt="../../_images/image34.PNG" src="../../_images/image34.PNG" style="width: 600px;" /></a>
</li>
</ol>
</div>
<div class="section" id="test-the-proactive-bot-defense-policy">
<h2>Test the Proactive Bot Defense Policy<a class="headerlink" href="#test-the-proactive-bot-defense-policy" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">From the command line execute the following command several times:</p>
<p><code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">https://webgoat.f5demo.com/WebGoat/login</span> <span class="pre">-k</span> <span class="pre">-v</span> <span class="pre">|</span> <span class="pre">more</span></code></p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This can take a few seconds to kick in and then you will see ASM start issuing a redirect challenge and try to set a TS cookie. <strong>307 Temporary Redirect</strong></p>
</div>
<a class="reference internal image-reference" href="../../_images/image38.PNG"><img alt="../../_images/image38.PNG" src="../../_images/image38.PNG" style="width: 600px;" /></a>
<ol class="arabic simple" start="2">
<li>Once the Grace Period of 20 seconds has expired you will see ASM start escalating the defense and start to return a javascript challenge.</li>
</ol>
<a class="reference internal image-reference" href="../../_images/image39.PNG"><img alt="../../_images/image39.PNG" src="../../_images/image39.PNG" style="width: 600px;" /></a>
<p>This bot is getting shot down in flames!</p>
</div>
<div class="section" id="validate-that-the-proactive-bot-defense-policy-is-working">
<h2>Validate that the Proactive Bot Defense Policy is Working<a class="headerlink" href="#validate-that-the-proactive-bot-defense-policy-is-working" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Navigate to <strong>Security &gt; Event Logs &gt; Bot Defense &gt; Requests</strong>.</li>
<li>Notice that the detected bot activity has been logged and is now
being displayed for review.</li>
</ol>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">This is very important to understand that we are logging bots in an entirely different internal logging system than the ASM events. Implementing Bot Defense keeps the ASM logs clean and actionable when there are millions of malicious attempts per day from bots.</p>
</div>
<a class="reference internal image-reference" href="../../_images/image1_3_11.PNG"><img alt="../../_images/image1_3_11.PNG" src="../../_images/image1_3_11.PNG" style="width: 600px;" /></a>
<ol class="arabic simple">
<li>Note the stated reason for the request being blocked. You may have to
scroll to the right to see this reason. What was the stated reason?</li>
</ol>
</div>
<div class="section" id="bot-signatures">
<h2>BOT Signatures<a class="headerlink" href="#bot-signatures" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Navigate to <strong>Security &gt; DoS Protection &gt; DoS Profiles</strong></p>
</li>
<li><p class="first"><strong>Click</strong> on the <code class="docutils literal notranslate"><span class="pre">webgoat_DoS</span></code> profile and then the
<strong>Application Security</strong> tab to configure the policy.</p>
</li>
<li><p class="first">Select <strong>Proactive Bot Defense</strong> under the list of <strong>Application
Security</strong> options.</p>
</li>
<li><p class="first">In the <strong>Application Security &gt; Proactive Bot Defense</strong>
section, click the <strong>Edit</strong> link for <strong>Operation Mode</strong> and
then change the setting from <strong>Always</strong> to <strong>During Attack</strong> and
click <strong>Update</strong> to complete the policy change.</p>
<a class="reference internal image-reference" href="../../_images/image1_3_12.PNG"><img alt="../../_images/image1_3_12.PNG" src="../../_images/image1_3_12.PNG" style="width: 600px;" /></a>
</li>
<li><p class="first">Run cURL again: <code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">https://webgoat.f5demo.com/WebGoat/login</span> <span class="pre">-k</span> <span class="pre">-v</span> <span class="pre">|</span> <span class="pre">more</span></code></p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The site should respond normally now every time because we are not “under attack” ASM uses TPS based detection (client-side) and Behavioral Stress detection (server-side) to determine when the system is under attack. Without the Advanced WAF license, Behavioral DoS Detection is limited to two virtual servers.</p>
</div>
<p>cURL is considered an <strong>HTTP Library tool</strong> and falls in <strong>the Benign Category</strong>.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Just how benign are HTTP library tools? cURL can easily be
scripted in a variety of ways and can be used as a downloader to siphon
off data. Remember the famous media defined “hacking tool” that Snowden
used? wget? There are many use-cases where you simply do not want a tool
interacting with your site.</p>
</div>
</div>
<div class="section" id="selectively-blocking-bot-categories">
<h2>Selectively Blocking BOT Categories<a class="headerlink" href="#selectively-blocking-bot-categories" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Under your <code class="docutils literal notranslate"><span class="pre">webgoat_DoS</span></code> profile in <strong>Application Security &gt; Bot
Signatures</strong> click on the <strong>Edit</strong> link for the <strong>Bot Signature
Categories</strong> section.</p>
<a class="reference internal image-reference" href="../../_images/image1_3_13.PNG"><img alt="../../_images/image1_3_13.PNG" src="../../_images/image1_3_13.PNG" style="width: 600px;" /></a>
</li>
<li><p class="first">Change the HTTP Library action from <strong>None</strong> to <strong>Block</strong> under
the <strong>Benign Categories</strong> section and click <strong>Update</strong> to apply
the policy changes.</p>
<a class="reference internal image-reference" href="../../_images/image1_3_14.PNG"><img alt="../../_images/image1_3_14.PNG" src="../../_images/image1_3_14.PNG" style="width: 600px;" /></a>
</li>
<li><p class="first">Run cURL again: <code class="docutils literal notranslate"><span class="pre">curl</span>&#160; <span class="pre">https://webgoat.f5demo.com/WebGoat/login</span> <span class="pre">-k</span> <span class="pre">-v</span> <span class="pre">|</span> <span class="pre">more</span></code></p>
<a class="reference internal image-reference" href="../../_images/image35.PNG"><img alt="../../_images/image35.PNG" src="../../_images/image35.PNG" style="width: 600px;" /></a>
<p>Whammo!!!… as soon as the BOT is revealed… the connection is dropped.
The TLS doesn’t get established.</p>
<p>Let’s say we actually DO want to allow cURL or another automated
tool. We may have developers that rely on curl so let’s whitelist
just that.</p>
</li>
</ol>
<p><strong>To Whitelist cURL:</strong></p>
<ol class="arabic simple">
<li>Edit the <strong>Bot Signatures</strong> list and find <strong>curl</strong>. Move it to disabled signatures and click <strong>Update</strong>.</li>
</ol>
<a class="reference internal image-reference" href="../../_images/image1_3_16.PNG"><img alt="../../_images/image1_3_16.PNG" src="../../_images/image1_3_16.PNG" style="width: 600px;" /></a>
<ol class="arabic simple">
<li>Run cURL again: <code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">https://webgoat.f5demo.com/WebGoat/login</span> <span class="pre">-k</span> <span class="pre">-v</span> <span class="pre">|</span> <span class="pre">more</span></code> and you should be back in business. By now you should know the expected output.</li>
<li>Change HTTP Library to: <strong>Report</strong> and remove <strong>CURL</strong> from the whitelist.</li>
</ol>
<a class="reference internal image-reference" href="../../_images/image1_3_17.PNG"><img alt="../../_images/image1_3_17.PNG" src="../../_images/image1_3_17.PNG" style="width: 600px;" /></a>
<ol class="arabic simple">
<li>Modify the <code class="docutils literal notranslate"><span class="pre">webgoat_DOS</span></code> Dos Profile operation Operation Mode to: <code class="docutils literal notranslate"><span class="pre">Always</span></code> and click <strong>Update</strong>.</li>
</ol>
<a class="reference internal image-reference" href="../../_images/image1_3_18.PNG"><img alt="../../_images/image1_3_18.PNG" src="../../_images/image1_3_18.PNG" style="width: 600px;" /></a>
</div>
<div class="section" id="curl-from-different-geolocations">
<h2>cURL from Different Geolocations<a class="headerlink" href="#curl-from-different-geolocations" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We are going to leverage an overlay virtual server to randomize source IP addresses similar to the earlier lab concept of randomizing XFF.</p>
</div>
<p>1. Open <strong>Local Traffic &gt; Virtual Servers</strong> and click on <code class="docutils literal notranslate"><span class="pre">webgoat.f5demo.com_https_overlay_vs</span></code>.
Go to the <strong>Resources</strong> horizontal tab and verify that the iRule <strong>webgoat_overlay</strong> is applied. Freel free to check out the code in the iRule. This code and BIG-IP flexibility makes lab testing and simulations a breeze.</p>
<a class="reference internal image-reference" href="../../_images/image1_3_19.PNG"><img alt="../../_images/image1_3_19.PNG" src="../../_images/image1_3_19.PNG" style="width: 600px;" /></a>
<ol class="arabic simple" start="2">
<li>Modify the cURL command to point at the overlay virtual server and run several times: <code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">https://10.1.10.146/WebGoat/login</span> <span class="pre">-k</span> <span class="pre">-v</span> <span class="pre">|</span> <span class="pre">more</span></code></li>
<li>Review the event logs at <strong>Event Logs &gt; Bot Defense</strong> You will
now see geo-data for the BOT connection attempts.</li>
</ol>
<a class="reference internal image-reference" href="../../_images/image1_3_20.PNG"><img alt="../../_images/image1_3_20.PNG" src="../../_images/image1_3_20.PNG" style="width: 600px;" /></a>
<ol class="arabic simple" start="4">
<li>Navigate to <strong>Security &gt; Overview &gt; Application &gt; Traffic</strong> and review the default
report elements. You can change the widget time frames to see more historical data.</li>
<li>Click <strong>Overview &gt; Application &gt; Traffic</strong> and override the timeframe to <strong>past year</strong>:</li>
</ol>
<a class="reference internal image-reference" href="../../_images/image1_3_21.PNG"><img alt="../../_images/image1_3_21.PNG" src="../../_images/image1_3_21.PNG" style="width: 600px;" /></a>
<ol class="arabic simple" start="6">
<li>Take some time reviewing this screen and practice adding a new widget
to see additional reporting elements:</li>
<li>Click the <strong>DoS tab</strong> at the top. In some time…The DOS Visibility Screen loads.</li>
</ol>
<a class="reference internal image-reference" href="../../_images/image1_3_22.PNG"><img alt="../../_images/image1_3_22.PNG" src="../../_images/image1_3_22.PNG" style="width: 600px;" /></a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may need to change your time in the system tray for accurate results.</p>
</div>
<p>Although there have not been any L7 DoS attacks some of the widgets along the right contain statistics from the BOT mitigations.
Change the time window (top left) from 5 minutes to <strong>“All Time”</strong> so see more data.</p>
<a class="reference internal image-reference" href="../../_images/image41.PNG"><img alt="../../_images/image41.PNG" src="../../_images/image41.PNG" style="width: 600px;" /></a>
<ol class="arabic simple" start="8">
<li>Click the <strong>Analysis</strong> tab at the top and review the graphs available to you.</li>
</ol>
<a class="reference internal image-reference" href="../../_images/image1_3_23.PNG"><img alt="../../_images/image1_3_23.PNG" src="../../_images/image1_3_23.PNG" style="width: 600px;" /></a>
<ol class="arabic simple" start="9">
<li>Click the <strong>Custom Page</strong> tab at the top and review the graphs available to you.</li>
</ol>
<p>Please feel free to add widgets and/or explore the ASM interface further.</p>
<p><strong>This concludes the BOT Protection section of this lab guide!</strong></p>
</div>
</div>


        
		     <div class="row next-prev-btn-row">
           <div class="col-lg-12">
           
		        <a href="../lab1/lab1.html" title="Exercise 1.1: Policy Creation" accesskey="p" class="btn btn-primary pull-left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
           
           
              <a href="../../module2/module2.html" title="Module 2: Transparent Security Policy" accesskey="n" class="btn btn-primary pull-right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
           
		     </div>
         </div>
        
      </div>
    </div>
  </div>


      <div class="container-fluid">
      <div class="row">
        <div class="content-fluid pre-footer">
          <div class="blocks-container">
            <div class="block">
              <h3>Support Programs</h3>
              <p>Regionally located support centers enable F5 to provide support in a number of languages through native-speaking support engineers.</p>
              <a class="btn internalLink" data-ng-href="https://f5.com/support/support-offerings" target="_blank" href="https://f5.com/support/support-offerings">See more
                <span class="icon-1x-right icon-new-window" data-icon="new-window">​</span>
              </a>
            </div>
            <div class="block">
              <h3>Contact Support</h3>
              <p>
                North America: 1-888-882-7535<br>
                Outside North America: 800-11-275-435
              </p>
              <a class="btn internalLink" data-ng-href="https://f5.com/about-us/contact#regional-support" target="_blank" href="https://f5.com/about-us/contact#regional-support">Local Support Numbers
                <span class="icon-1x-right icon-new-window" data-icon="new-window">​</span>
              </a>
            </div>
            <div class="block">
              <h3>Feedback and Help</h3>
              <p>Have questions, suggestions, or just want to get something off your chest? Let us know.</p>
              <a class="btn" data-ui-sref="siteFeedback" target="_blank" href="https://support.f5.com/csp/siteFeedback">Leave feedback</a>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="footer">
          <div class="container">
            <div class="col-sm-3 col-md-2">
              <h4>About F5</h4>
              <ul>
                <li><a data-ng-href="https://f5.com/about-us/contact" target="_blank" data-link-type="footer" href="https://f5.com/about-us/contact" class="internalLink">Contact F5</a>
                </li>
                <li><a data-ng-href="https://f5.com/about-us/careers" target="_blank" data-link-type="footer" href="https://f5.com/about-us/careers" class="internalLink">Careers</a>
                </li>
              </ul>
            </div>
            <div class="col-sm-3 col-md-2">
              <h4>Education</h4>
              <ul>
                <li><a data-ng-href="https://f5.com/education/training" target="_blank" data-link-type="footer" href="https://f5.com/education/training" class="internalLink">Training</a>
                </li>
                <li><a data-ng-href="https://f5.com/education/certification" target="_blank" data-link-type="footer" href="https://f5.com/education/certification" class="internalLink">Certification</a>
                </li>
                <li><a data-ng-href="https://f5.com/education/training/free-courses" target="_blank" data-link-type="footer" href="https://f5.com/education/training/free-courses" class="internalLink">Free Online Training</a>
                </li>
              </ul>
            </div>

            <div class="col-sm-3 col-md-2">
              <h4>F5 sites</h4>
              <ul>
              <li><a data-ng-href="https://f5.com" target="_blank" data-link-type="footer" href="https://f5.com" class="internalLink">F5.com</a>
              </li>
              <li><a data-ng-href="https://devcentral.f5.com" target="_blank" data-link-type="footer" href="https://devcentral.f5.com" class="internalLink">Community</a>
              </li>
              <li><a data-ng-href="https://partners.f5.com" target="_blank" data-link-type="footer" href="https://partners.f5.com" class="internalLink">Partners</a>
              </li>
          </ul>
      </div>

      <div class="col-sm-3 col-md-2">
          <h4>Support Tasks</h4>
          <ul>
              <li><a data-ui-sref="mySupport.createServiceRequest" data-link-type="footer" href="https://support.f5.com/csp/my-support/service-request">Create Service Request </a>
              </li>
              <li><a data-ng-href="https://f5.com/about-us/contact#regional-support" target="_blank" data-link-type="footer" href="https://f5.com/about-us/contact#regional-support" class="internalLink">Contact Support</a>
              </li>
              <li><a data-ui-sref="siteFeedback" target="_blank" data-link-type="footer" href="https://support.f5.com/csp/siteFeedback">Leave feedback [+]</a>
              </li>
          </ul>
      </div>

      <div class="col-xs-12 col-md-3 right">
          <h4>Connect with us</h4>
          <ul class="social_icons">
              <li><a href="//twitter.com/f5networks" target="_blank" data-name="twitter" data-type="" data-prefix="social" data-utf="E032" title="Twitter" class="externalLink"><i class="icon-1x icon-twitter icon-inverse-circle" data-link-type="footer"></i></a></li>
              <li><a href="//www.linkedin.com/companies/f5-networks" target="_blank" class="linkedin externalLink" title="LinkedIn"><i class="icon-1x icon-linkedin icon-inverse-circle" data-link-type="footer"></i></a></li>
              <li><a href="//www.facebook.com/f5networksinc" target="_blank" class="facebook externalLink" title="Facebook"><i class="icon-1x icon-facebook icon-inverse-circle" data-link-type="footer"></i></a></li>
              <li><a href="//www.youtube.com/f5networksinc" target="_blank" class="youtube externalLink" title="YouTube"><i class="icon-1x icon-youtube icon-inverse-circle" data-link-type="footer"></i></a></li>
              <li><a data-ng-href="https://devcentral.f5.com" target="_blank" class="devcentral internalLink" title="DevCentral" href="https://devcentral.f5.com"><i class="icon-1x icon-dc-pos icon-inverse-circle" data-link-type="footer"></i></a></li>
          </ul>
      </div>

      <div class="content-fluid left">
          <div class="col-xs-12">
              <p>
                  © Copyright <span class="ng-binding">2017</span> by F5 Networks, Inc. |
                  <a data-ng-href="https://f5.com/about-us/policies" target="_blank" data-link-type="footer" href="https://f5.com/about-us/policies" class="internalLink">Policies</a> |
                  <a data-ng-href="https://f5.com/about-us/policies/trademarks" target="_blank" data-link-type="footer" href="https://f5.com/about-us/policies/trademarks" class="internalLink">Trademarks</a>
              </p>
          </div>
      </div>
  </div>
</div>
  </div>
</div>

  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    jQuery.noConflict(true)
  </script>
  </body>
</html>